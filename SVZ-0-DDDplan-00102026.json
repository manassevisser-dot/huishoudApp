{
  "Producing_Role": "CEO Manasse",
  "Artifact_ID": "SVZ-0-DDDplan-00102026",
  "Status": "PENDING",
  "Token_ID": "TOKEN-ID-MANASSE-SVZ0-5B59F2AB",
  "Runtime_Environment": "NODE_TERMINAL",
  "SHA256_Hash": "5b59f2ab9c8cc5fc9e625da723980b8993c3d6f48abca7dbe576686594b63de6",
  "Source_Commit": "MANUAL_CLI_INPUT",
  "PII_Attestation": "NEE - CLEAN",
  "File_Name": "plan_kort.txt",
  "Raw_Content": "Het plan â€” vanuit de noodzaak van de mislukte refactor\r\nDe huidige wizardâ€‘app is instabiel geraakt omdat de eerdere refactor halverwege is blijven steken. Hierdoor zitten logica, validatie en UIâ€‘weergave nu door elkaar, waardoor:\r\n\r\nvelden niet meer goed zichtbaar zijn of verdwijnen,\r\nvalidatie onvoorspelbaar werkt,\r\nde wizard state inconsistent is,\r\ntests niet kloppen of helemaal ontbreken,\r\nfixes in de ene plek iets anders breken,\r\nuitbreiden vrijwel onmogelijk is.\r\n\r\nDaarom moet het project opnieuw, maar dit keer gestructureerd worden opgebouwd.\r\n\r\nğŸ¯ Kern van het plan\r\n1ï¸âƒ£ Domeinlogica moet uit de UI\r\nMomenteel zit businessâ€‘logica (visibility, berekeningen, validatie) verspreid door UIâ€‘componenten.\r\nDat maakt het ontestbaar, foutgevoelig en onmogelijk te migreren.\r\nPlan:\r\n\r\nAlle businessâ€‘regels verhuizen naar Ã©Ã©n centrale domainâ€‘laag (pure functies, voorspelbaar, testbaar).\r\n\r\n\r\n2ï¸âƒ£ Er moet een duidelijke scheiding komen tussen:\r\n\r\nDomain (regels, validatie, visibility, berekeningen)\r\nApp (FormState, orchestrators, adapters, ValueProvider)\r\nUI (dumb components + config)\r\n\r\nNu lopen deze drie lagen volledig door elkaar. Dat is precies waarom de refactor stukging.\r\nPlan:\r\n\r\nDomain wordt â€œzuiverâ€\r\nAppâ€‘laag krijgt Ã©Ã©n verantwoordelijkheid: state beheren en domain aansturen\r\nUI verwacht alleen props en configs, geen logica\r\n\r\n\r\n3ï¸âƒ£ Configâ€‘bestanden moeten leidend worden\r\nDe wizardâ€‘paginaâ€™s moeten volledig configâ€‘gedreven werken.\r\nNu zit er nog logica in:\r\n\r\nWizardPage\r\nFieldRenderer\r\n.config.ts files\r\nlosse componenten\r\n\r\nPlan:\r\n\r\nConfig bestanden bevatten alleen data (velden, labels, types)\r\nDomain bepaalt:\r\n\r\nzichtbaarheid\r\nconstraints\r\nberekeningen\r\n\r\n\r\nUI rendert alleen wat je opgeeft\r\n\r\n\r\n4ï¸âƒ£ Velden moeten via Ã©Ã©n consistent systeem worden opgehaald\r\nNa de mislukte refactor zijn er:\r\n\r\ntwee verschillende ValueProviders\r\nmeerdere manieren om dingen uit state te lezen\r\ninconsistent pathâ€‘gebruik voor velden\r\n\r\nPlan:\r\n\r\nÃ‰Ã©n FieldPathResolver\r\nÃ‰Ã©n ValueProvider\r\nEÃ©n FormStateValueProvider adapter\r\nâ†’ zodat elk veld voorspelbaar werkt.\r\n\r\n\r\n5ï¸âƒ£ Validatie moet gecentraliseerd en volledig testbaar worden\r\nNu is validatie verspreid en deels kapot.\r\nSommige velden hebben min/max op root, andere in validation, sommige nergens.\r\nPlan:\r\n\r\nEÃ©n domeinvalidator\r\nEÃ©n bron van waarheid voor regels\r\nSnapshotâ€‘tests om bestaand gedrag vast te leggen\r\nDaarna uitbreiden met veilige, gecontroleerde wijzigingen\r\n\r\n\r\n6ï¸âƒ£ De wizard flow moet weer betrouwbaar worden\r\nOmdat de huidige flow afhankelijk is van incomplete configuraties en uit elkaar gevallen orchestrators, werkt de wizard niet meer stabiel.\r\nPlan:\r\n\r\nAppâ€‘laag herstructureren (FormStateOrchestrator)\r\nWizard moet state ontvangen uit appâ€‘laag, niet meer zelf puzzelen\r\nGeen logica in WizardPage of FieldRenderer\r\n\r\n\r\n7ï¸âƒ£ Testen moeten opnieuw worden opgebouwd\r\nJe hebt nu Â±1,14% coverage â€” vrijwel niets werkt nog.\r\nPlan:\r\n\r\nNieuwe domainâ€‘testen\r\nNieuwe appâ€‘laag integratietesten\r\nUIâ€‘renderingâ€‘testen zonder logica\r\nBaselines om bestaand gedrag vast te leggen (belangrijk voor vertrouwen)\r\n\r\n\r\nğŸ Het eindresultaat\r\nWanneer dit plan is uitgevoerd:\r\n\r\nDe app werkt weer stabiel\r\nBusinesslogica zit volledig in domain\r\nUI is clean, simpel, uitbreidbaar\r\nWizard werkt consistent per stap\r\nValidatie en zichtbaarheid zijn voorspelbaar\r\nNieuwe features toevoegen is veilig\r\nJe hebt volledige testdekking en snapshots\r\nJe weet zeker dat refactoren niet weer alles breekt\r\n\r\n"
}