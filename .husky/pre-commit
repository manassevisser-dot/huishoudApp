# .husky/pre-commit
#!/usr/bin/env bash
set -euo pipefail

echo "ğŸ¦… Phoenix Gate A - Pre-commit Quality Check"
echo ""

# === GATE A: PHOENIX ===
if node scripts/phoenix/quinn-adapter.js; then
    echo ""
    echo "âœ… Gate A: GO - All Phoenix checks passed"
    echo ""
else
    echo ""
    echo "âŒ Gate A: STOP - Fix violations before commit"
    echo ""
    echo "Quick fixes:"
    echo "  - npm run sync:aliases        (alias consistency)"
    echo "  - npm run lint -- --fix       (ESLint errors)"
    echo "  - Remove HTML tags             (use <View>/<Text>)"
    echo ""
    exit 1
fi

# Optioneel: CleanCode check (non-blocking)
echo "ğŸ“Š Running CleanCode checklist..."
node scripts/maintenance/cleancode-automator.js || true

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… Pre-commit checks passed!"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
```

### **Stap 4: Update Phoenix EOD**

```bash
# phoenix-audit-v2.sh (of je main Phoenix script)

cmd_full() {
    log_info "ğŸŒ… Phoenix End-of-Day run..."
    
    # === 0. GATE A: AUTOMATED QUALITY ===
    log_info "ğŸ¦… Gate A: Phoenix Quality Checks..."
    if ! npm run gate:a; then
        log_err "Gate A STOP: Fix violations before continuing"
        return 1
    fi
    
    # === 1. Alias sync ===
    npm run sync:aliases -- --strict || return 1
    
    # === 2. Linting ===
    npm run lint -- --fix
    
    # === 3. Tests ===
    cmd_test || return 1
    
    # === 4. Trinity scores ===
    # ... bestaande logic
    
    # === 5. Git commit ===
    # ... bestaande logic
    
    log_info "âœ… Phoenix EOD complete (Gate A â†’ Trinity â†’ Commit)"
}
```

---

## ğŸ§ª **TESTEN**

### **Test 1: Gate A Direct**

```bash
npm run gate:a
```

**Verwacht:**
```
ğŸ¦… Phoenix Gate A - Code Quality Check

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“‹ Validator Results:

âœ… Alias Consistency passed [BLOCKING]
âœ… Forbidden Patterns passed [BLOCKING]
âœ… ESLint Compliance passed [BLOCKING]

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… Verdict: GO

â±ï¸  Execution Time: 1234ms
ğŸ“„ Report: reports/phoenix-gate-a-report.json